<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="IE=edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="GC6R-SxUqF6fYOSa_PtF-epaoitzWq535hkI7LoB13M" name="google-site-verification">
<title>  Addressing Self-Induced Poetry Problems on my M1 MacBook
 | Principia Nugae</title>
<meta content="Mark Baggett" name="author">
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css" rel="stylesheet"/>
<link href="./theme/css/jquery.mglass.css" rel="stylesheet"/>
<link href="./theme/css/pygment-solarized-dark.css" rel="stylesheet"/>
<link href="./theme/css/style.css" rel="stylesheet"/>
<!-- Fonts -->
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css"/>
<link href="https://fonts.googleapis.com/css?family=Istok+Web" rel="stylesheet" type="text/css"/>
<link href="https://fonts.googleapis.com/css?family=Droid+Sans+Mono" rel="stylesheet" type="text/css"/>
<link href="./favicon.ico" rel="icon" type="image/x-icon"/>
<link href="./favicon.ico" rel="shortcut icon" type="image/x-icon"/>
<!-- Feeds -->
</meta></meta><link href="https://markpbaggett.github.io/poetry_on_m1.html" rel="canonical"/><script type="application/ld+json">{"@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{"@type": "ListItem", "position": 1, "name": "Principia Nugae", "item": "https://markpbaggett.github.io"}, {"@type": "ListItem", "position": 2, "name": "Poetry_on_m1", "item": "https://markpbaggett.github.io/poetry_on_m1.html"}]}</script><script type="application/ld+json">{"@context": "https://schema.org", "@type": "Article", "author": {"@type": "Person", "name": "Mark Baggett"}, "publisher": {"@type": "Organization", "name": "Principia Nugae"}, "headline": "Addressing Self-Induced Poetry Problems on my M1 MacBook", "about": "python", "datePublished": "2022-12-23 00:00"}</script></head>
<body>
<div class="container">
<div class="page-header">
<a class="avatar-container pull-left" href=".">
<div class="avatar">
<div class="side"><img class="img-responsive" src="https://avatars.githubusercontent.com/u/2692416?v=4"/></div>
</div>
</a>
<h1><a href=".">Principia Nugae</a> <small></small></h1>
</div>
<nav class="navbar navbar-default">
<!-- Hamburger menu for mobile -->
<div class="navbar-header">
<button aria-expanded="false" class="navbar-toggle collapsed" data-target="#plumage-navbar-collapse-1" data-toggle="collapse" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="." title="">Principia Nugae</a>
</div>
<!-- Menus and search forms -->
<div class="collapse navbar-collapse" id="plumage-navbar-collapse-1">
<ul class="nav navbar-nav">
<li>
<a href="./pages/about.html">About</a>
</li>
<li>
<a href="./category/iiif.html">iiif</a>
</li>
<li>
<a href="./category/misc.html">misc</a>
</li>
<li class="active">
<a href="./category/python.html">python <span class="sr-only">(current)</span></a>
</li>
</ul>
</div>
</nav>
</div>
<div class="container main">
<div class="row">
<div class="col-md-9">
<h1>
<a href="./poetry_on_m1.html" rel="bookmark" title="Permalink to Addressing Self-Induced Poetry Problems on my M1 MacBook">Addressing Self-Induced Poetry Problems on my M1 MacBook</a>
</h1>
</div>
</div>
<div class="row">
<div class="col-md-9" id="content" role="main">
<div>
<p>Since 2015 or 2016, I have used System 76 laptops exclusively with Ubuntu or Pop 0S. Recently, a
change in university procurement policy required me to switch my university issued System 76 Oryx Pro to either a M1
Macbook or Dell Laptop. Since, nearly everyone I know uses a Macbook, I thought I'd try giving development with OSX
another shot.</p>
<p>While I'm still figuring things out, the hardest transition for me so far personally has been porting over my Python
development practice to this new hardware. Currently, I use <a class="reference external" href="https://python-poetry.org/">poetry</a> for dependency
management and deployment with <a class="reference external" href="https://www.jetbrains.com/pycharm/">Pycharm</a> as an IDE.</p>
<p>When I got the M1 Macbook, I did not realize how many of my core dependencies were compiled for x86 architecture and had
no ARM equivalent. Therefore, I'd install an application with <cite>poetry install</cite> and get no errors until I ran the application.
When I ran the application in the wrong architecture, it errored with a message telling me a depenedency installed had
been compiled for x86 or ARM.</p>
<p>It didn't take long until I discovered <a class="reference external" href="https://en.wikipedia.org/wiki/Rosetta_(software)">Rosetta</a> which allowed me to
emulate x86 as necessary. After installing Rosetta, I cloned Terminal and specified the clone to open with Rosetta.
Now, when I print architecture with <cite>arch</cite> in a terminal I get <cite>arm64</cite> when not using Rosetta and <cite>i386</cite> when I am. This
little trick can be invaluable when things go wrong.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span>arch
<span class="sb">`</span>i386<span class="sb">`</span>
</pre></div></td></tr></table></div>
<div class="section" id="when-things-go-wrong">
<h2>When Things Go Wrong</h2>
<p>Occasionally, I will still encounter errors like above even when I'm in a terminal that is emulating x86 or ARM.  This
often happens because of <cite>poetry</cite> and my inconsistent workflow. The <cite>poetry</cite> shell is always tied to whatever the architecture
was when the application was installed. Therefore, if you do <cite>poetry install</cite> in a ARM terminal but later do <cite>poetry shell</cite>
from a terminal with Rosetta, it will still use that original architecture like below.</p>
<img alt="Image Showing What Happens When You Execute a Poetry Shell Installed in Another Architecture" src="images/poetry_shell.png"/>
<p>When this happens and poetry has been installed or initialized in the wrong environment, you need to remove the
environment. To do this, start by getting the id for the environment with <cite>poetry env list</cite>. I'm not clear exactly how
this works, but you can use the command whether the poetry environment is activated or not:</p>
<img alt="Demoing the Output of Poetry Env List" src="images/poetry_shell2.png"/>
<p>You can get more information about the environment with <cite>poetry env info</cite>, but the command will not show the architecture.</p>
<img alt="Demoing the Output of Poetry Env Info" src="images/poetry_shell2.png"/>
<p>When you're ready, you can remove the environment by specifying its identifier and then reinstall in the correct architecture.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span>poetry env remove exodus-fY88g50b-py3.11
poetry install
</pre></div></td></tr></table></div>
<p>While all of this may seem obvious, this problem has cost me countless hours as well as significant hair loss. Hopefully,
taking the time to write this out will ensure this happens less frequently in the future.</p>
</div>
</div>
</div>
<div class="col-md-3">
<div class="well">
<p><abbr title="2022-12-23T00:00:00-05:00"><i class="fa fa-calendar"></i> Fri 23 December 2022</abbr></p>
<p><address>
<i class="fa fa-user"></i> By
          <a href="./author/mark-baggett.html" rel="author">Mark Baggett</a>
</address></p>
<hr/>
<p>
<a class="label label-info" data-toggle="tooltip" href="./category/python.html" rel="tag" title="2 articles in this category">python</a>
<a class="label label-default" data-toggle="tooltip" href="/tag/poetry.html" title="1 article with this tag">poetry</a>
<a class="label label-default" data-toggle="tooltip" href="/tag/m1.html" title="1 article with this tag">m1</a>
<a class="label label-default" data-toggle="tooltip" href="/tag/osx.html" title="1 article with this tag">osx</a>
<a class="label label-default" data-toggle="tooltip" href="/tag/macbook.html" title="1 article with this tag">macbook</a>
</p>
<hr/>
</div>
</div>
</div>
</div>
<!-- TODO: make footer sticky -->
<footer class="container-fluid">
<div class="container">
<div class="row">
<div class="col-md-2">
<h5>Social</h5>
<ul class="list-unstyled">
<li> <a href="https://github.com/markpbaggett">
<i class="fa fa-github"></i>
    github
  </a></li>
</ul>
</div>
<div class="col-md-2">
</div>
<div class="col-md-2">
<h5>Browse content by</h5>
<ul class="list-unstyled">
</ul>
</div>
<div class="col-md-2 text-muted">
<h5>Copyright notice</h5>
<p>Â© Copyright 2022 Mark Baggett.</p>
</div>
<div class="col-md-2 text-muted">
<h5>Disclaimer</h5>
<p>Views expressed here are my own, but you should adopt them immediately.</p>
</div>
<div class="col-md-2">
</div>
</div>
</div>
<h5 class="text-right"><a href="#"><i class="fa fa-arrow-up"></i> Back to top</a></h5>
<div class="container">
<div class="row col-md-12 text-muted text-center">
          Site generated by <a href="https://getpelican.com"> Pelican</a>.<br/>
<a href="https://github.com/kdeldycke/plumage"> Plumage</a> theme by <a href="https://kevin.deldycke.com">Kevin Deldycke</a>.
        </div>
</div>
</footer>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-L1RWHJC0V7"></script>
<script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', G-L1RWHJC0V7);
    </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/fitvids/1.1.0/jquery.fitvids.min.js"></script>
<script src="./theme/js/jquery.mglass.js"></script>
<script src="./theme/js/application.js"></script>
</body>
</html>